
<h3 translate="chefsApp.recipe.steps"></h3>
<div class="form-group">
    <textarea class="form-control" name="step_section" id="step_section"
              ng-model="step.section" placeholder="{{'chefsApp.recipe.step' | translate}}..."></textarea>
    <button type="button" class="btn btn-success" ng-click="addStep()">
        <span translate="global.add">Add</span>
    </button>
</div>

<!-- Steps -->
<div ui-sortable="sortableOptions" ng-model="recipe.steps">
    <div ng-repeat="s in recipe.steps" style="margin-top: 20px;">
        <hr ng-show="$index!=0" style="border-color: #5f5f5f;">
        <div class="row">
            <div class="col-sm-1">
                <p class="glyphicon glyphicon-remove" ng-click="deleteStep($index)" style="color: red;"></p>
                <p class="glyphicon glyphicon-move"></p>
            </div>
            <div class="col-sm-11">
                <input type="hidden" ng-init="s.position=$index">
                <textarea class="form-control"
                          ng-model="s.section"/>
                <button type="button" class="btn btn-success" ng-click="addImg(s)">
                    <span translate="entity.action.addimage">Add image</span>
                </button>
            </div>
<!-- Pictures -->
            <div ui-sortable="sortableOptions" ng-model="s.stepPicture">
                <div class="col-lg-12" ng-repeat="picture in s.stepPicture" style="margin-bottom: 20px;">
                    <div class="col-lg-1">
                        <p class="glyphicon glyphicon-remove" ng-click="deleteImg($parent.$index, $index)" style="color: red;"></p>
                        <p class="glyphicon glyphicon-move"></p>
                    </div>
                    <div class="col-lg-11" ngf-drop ngf-change="setSrc($file, picture)" ngf-pattern="'image/*'">
                        <div class="row">
                            <div class="col-xs-1">
                                <div class="help-block clearfix">
                                    <button ng-click="picture.src=null"
                                            ng-if="picture.src"
                                            class="btn btn-danger btn-xs pull-left">
                                        <span class="glyphicon glyphicon-remove"></span>
                                    </button>
                                </div>
                            </div>
                            <div class="col-xs-11">
                                <img class="img-responsive"
                                     data-ng-src="{{'data:image/*;base64,' + picture.src}}"
                                     ng-if="picture.src"/>
                                <input class="form-control" type="text" ng-model="picture.title" ng-if="picture.src"
                                       style="margin-top:10px;" placeholder="{{'entity.title' | translate}}...">
                            </div>
                        </div>
                        <button ng-if="!picture.src" type="file" ngf-select class="btn btn-primary btn-block"
                                ngf-change="setSrc($file, picture)" accept="image/*" translate="entity.action.addordropimage">
                        </button>
                        <input type="hidden" class="form-control"
                               ng-model="picture.src">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
